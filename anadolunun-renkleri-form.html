<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Anadolunun Renkleri Başvuru Formu | EBB Kültür Sanat</title>

    <!-- SEO Meta Tags -->
    <meta
      name="description"
      content="Anadolunun Renkleri etkinliği için başvuru formu. Erzurum Büyükşehir Belediyesi Kültür ve Sanat Merkezi."
    />
    <meta name="keywords" content="Anadolunun Renkleri, başvuru, form, Erzurum, kültür, sanat" />
    <meta name="author" content="Erzurum Büyükşehir Belediyesi" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="assets/Asset 1.png" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />

    <!-- Global Styles -->
    <link rel="stylesheet" href="css/global.css" />

    <!-- Styles -->
    <style>
      :root {
        --primary-color: #2c5aa0;
        --secondary-color: #4a90c2;
        --accent-color: #f39c12;
        --text-dark: #2c3e50;
        --text-light: #7f8c8d;
        --bg-light: #f8f9fa;
        --bg-white: #ffffff;
        --shadow-light: 0 2px 10px rgba(0, 0, 0, 0.1);
        --shadow-medium: 0 4px 20px rgba(0, 0, 0, 0.15);
        --shadow-heavy: 0 8px 30px rgba(0, 0, 0, 0.2);
        --border-radius: 12px;
        --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
        line-height: 1.6;
        color: var(--text-dark);
        background-color: var(--bg-white);
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 20px;
      }

      /* Hero Image Section */
      .hero-image-section {
        width: 100%;
        aspect-ratio: 16 / 9;
        overflow: hidden;
        position: relative;
        margin-top: var(--header-offset);
      }

      .hero-image-section img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .hero-image-overlay {
        position: absolute;
        inset: 0;
        background: linear-gradient(
          to bottom,
          rgba(0, 0, 0, 0.3),
          rgba(0, 0, 0, 0.6)
        );
      }

      /* Description Section */
      .description-section {
        padding: 4rem 0;
        background: var(--bg-light);
      }

      .description-content {
        max-width: 900px;
        margin: 0 auto;
        text-align: center;
      }

      .description-title {
        font-family: "Playfair Display", serif;
        font-size: clamp(2rem, 4vw, 3rem);
        color: var(--text-dark);
        margin-bottom: 1.5rem;
      }

      .description-text {
        font-size: 1.1rem;
        line-height: 1.8;
        color: var(--text-light);
        text-align: justify;
      }

      /* Form Section */
      .form-section {
        padding: 4rem 0;
        background: var(--bg-white);
      }

      .form-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        padding: 3rem;
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-medium);
      }

      .form-title {
        font-family: "Playfair Display", serif;
        font-size: 2rem;
        color: var(--primary-color);
        margin-bottom: 2rem;
        text-align: center;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-label {
        display: block;
        font-weight: 600;
        color: var(--text-dark);
        margin-bottom: 0.5rem;
        font-size: 0.95rem;
      }

      .form-label.required::after {
        content: " *";
        color: #e74c3c;
      }

      .form-control {
        width: 100%;
        padding: 0.9rem 1rem;
        border: 1px solid rgba(44, 90, 160, 0.2);
        border-radius: 8px;
        font-size: 1rem;
        font-family: inherit;
        transition: var(--transition);
        background: #f8f9ff;
      }

      .form-control:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        background: white;
      }

      .form-control.error {
        border-color: #e74c3c;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
      }

      .radio-group {
        display: flex;
        gap: 2rem;
        margin-top: 0.5rem;
      }

      .radio-option {
        display: flex;
        align-items: center;
        gap: 0.5rem;
      }

      .radio-option input[type="radio"] {
        width: 18px;
        height: 18px;
        cursor: pointer;
      }

      .radio-option label {
        cursor: pointer;
        font-weight: 500;
        margin: 0;
      }

      .btn-submit {
        width: 100%;
        padding: 1rem 2rem;
        background: linear-gradient(135deg, var(--accent-color), #f1c40f);
        color: white;
        border: none;
        border-radius: var(--border-radius);
        font-size: 1.1rem;
        font-weight: 700;
        cursor: pointer;
        transition: var(--transition);
        margin-top: 1rem;
      }

      .btn-submit:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-medium);
      }

      .btn-submit:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
      }

      .field-error {
        color: #e74c3c;
        font-size: 0.875rem;
        margin-top: 0.25rem;
        display: none;
      }

      .success-message {
        background: #28a745;
        color: white;
        padding: 1rem;
        border-radius: 8px;
        margin-bottom: 1.5rem;
        text-align: center;
        display: none;
      }

      @media (max-width: 768px) {
        .form-row {
          grid-template-columns: 1fr;
        }

        .form-container {
          padding: 2rem 1.5rem;
        }

        .description-section {
          padding: 3rem 0;
        }
      }
    </style>
  </head>
  <body class="has-fixed-header">
    <!-- Header -->
    <header class="header">
      <nav class="nav container">
        <a href="index.html" class="logo">
          <img src="assets/Asset 1.png" alt="EBB Logo" />
          <span>EBB Kültür Sanat</span>
        </a>

        <ul class="nav-menu" id="navMenu">
          <li><a href="index.html" class="nav-link">Ana Sayfa</a></li>
          <li><a href="calendar.html" class="nav-link">Etkinliklermiz</a></li>
          <li><a href="ourhalls.html" class="nav-link">Salonlarımız</a></li>
          <li><a href="news-list.html" class="nav-link">Haberler</a></li>
          <li class="nav-item has-dropdown">
            <a href="#" class="nav-link has-dropdown active">Formlar</a>
            <ul class="dropdown-menu" id="formsDropdown">
              <li>
                <a
                  href="anadolunun-renkleri-form.html"
                  class="dropdown-item active"
                  >Anadolunun Renkleri Başvuru Formu</a
                >
              </li>
            </ul>
          </li>
          <li><a href="index.html#contact" class="nav-link">İletişim</a></li>
        </ul>

        <button class="mobile-menu-btn" id="mobileMenuBtn">
          <i class="fas fa-bars"></i>
        </button>
      </nav>
    </header>

    <!-- Hero Image Section -->
    <section class="hero-image-section">
      <img
        src="https://via.placeholder.com/1920x1080/2c5aa0/ffffff?text=Anadolunun+Renkleri"
        alt="Anadolunun Renkleri"
      />
      <div class="hero-image-overlay"></div>
    </section>

    <!-- Description Section -->
    <section class="description-section">
      <div class="container">
        <div class="description-content">
          <h1 class="description-title">Anadolunun Renkleri</h1>
          <div class="description-text">
            <p>
              Anadolunun Renkleri, Türkiye'nin zengin kültürel mirasını ve
              geleneksel sanatlarını yansıtan özel bir etkinliktir. Bu etkinlik,
              Anadolu'nun farklı bölgelerinden gelen sanatçıları bir araya
              getirerek, geleneksel müzik, dans, el sanatları ve kültürel
              değerlerimizi tanıtmayı amaçlamaktadır.
            </p>
            <p>
              Etkinliğimize katılmak isteyen katılımcılar, aşağıdaki formu
              doldurarak başvurularını yapabilirler. Başvurular değerlendirildikten
              sonra, seçilen katılımcılara bilgilendirme yapılacaktır.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Form Section -->
    <section class="form-section">
      <div class="container">
        <div class="form-container">
          <h2 class="form-title">Başvuru Formu</h2>

          <div class="success-message" id="successMessage">
            Başvurunuz başarıyla gönderildi! En kısa sürede size dönüş yapacağız.
          </div>

          <form id="applicationForm">
            <div class="form-row">
              <div class="form-group">
                <label for="firstName" class="form-label required">Ad</label>
                <input
                  type="text"
                  id="firstName"
                  name="firstName"
                  class="form-control"
                  placeholder="Adınızı girin"
                  required
                />
                <div class="field-error" id="firstName-error"></div>
              </div>

              <div class="form-group">
                <label for="lastName" class="form-label required">Soyad</label>
                <input
                  type="text"
                  id="lastName"
                  name="lastName"
                  class="form-control"
                  placeholder="Soyadınızı girin"
                  required
                />
                <div class="field-error" id="lastName-error"></div>
              </div>
            </div>

            <div class="form-group">
              <label for="birthDate" class="form-label required"
                >Doğum Tarihi</label
              >
              <input
                type="date"
                id="birthDate"
                name="birthDate"
                class="form-control"
                required
              />
              <div class="field-error" id="birthDate-error"></div>
            </div>

            <div class="form-group">
              <label class="form-label required">Cinsiyet</label>
              <div class="radio-group">
                <div class="radio-option">
                  <input
                    type="radio"
                    id="genderMale"
                    name="gender"
                    value="bay"
                    required
                  />
                  <label for="genderMale">Bay</label>
                </div>
                <div class="radio-option">
                  <input
                    type="radio"
                    id="genderFemale"
                    name="gender"
                    value="bayan"
                    required
                  />
                  <label for="genderFemale">Bayan</label>
                </div>
              </div>
              <div class="field-error" id="gender-error"></div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="phone" class="form-label required">Telefon</label>
                <input
                  type="tel"
                  id="phone"
                  name="phone"
                  class="form-control"
                  placeholder="+90 5XX XXX XX XX"
                  required
                />
                <div class="field-error" id="phone-error"></div>
              </div>

              <div class="form-group">
                <label for="email" class="form-label required">E-posta</label>
                <input
                  type="email"
                  id="email"
                  name="email"
                  class="form-control"
                  placeholder="ornek@email.com"
                  required
                />
                <div class="field-error" id="email-error"></div>
              </div>
            </div>

            <button type="submit" class="btn-submit" id="submitBtn">
              <i class="fas fa-paper-plane me-2"></i>Başvuruyu Gönder
            </button>
          </form>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer" id="siteFooter">
      <div class="container">
        <div class="footer-content">
          <div class="footer-section">
            <h3>EBB Kültür Sanat Merkezi</h3>
            <p>
              Erzurum'un kültürel yaşamının kalbi olan merkezimizde, sanat ve
              kültürün her dalında etkinlikler düzenliyoruz.
            </p>
            <div class="social-links">
              <a
                href="https://www.facebook.com/EbbSanatMerkezi"
                class="social-link"
                target="_blank"
              >
                <i class="fab fa-facebook-f"></i>
              </a>
              <a
                href="https://www.instagram.com/ebbsanatmerkezi"
                class="social-link"
                target="_blank"
              >
                <i class="fab fa-instagram"></i>
              </a>
              <a
                href="https://twitter.com/erzurumbld"
                class="social-link"
                target="_blank"
                rel="noopener"
              >
                <i class="fab fa-twitter"></i>
              </a>
              <a
                href="https://www.youtube.com/@erzurumbuyuksehirbelediyes2404"
                class="social-link"
                target="_blank"
                rel="noopener"
              >
                <i class="fab fa-youtube"></i>
              </a>
            </div>
          </div>

          <div class="footer-section">
            <h3>Hızlı Linkler</h3>
            <p><a href="index.html">Ana Sayfa</a></p>
            <p><a href="calendar.html">Programlar</a></p>
            <p><a href="index.html#features">Hizmetler</a></p>
            <p><a href="ourhalls.html">Salonlarımız</a></p>
            <p><a href="activity.html">Yönetim Paneli</a></p>
          </div>

          <div class="footer-section">
            <h3>İletişim</h3>
            <p><i class="fas fa-phone"></i> +90 (442) 233 33 23</p>
            <p><i class="fas fa-envelope"></i> bilgi@ebbkultursanat.com</p>
            <p><i class="fas fa-clock"></i> Pzt-Cum: 09:00-18:00</p>
            <p>
              <i class="fas fa-map-marker-alt"></i> Muratpaşa Mah. Cumhuriyet
              Cad. Erzincankapı Sok. Dadaş Sitesi 1/1 Yakutiye Erzurum
            </p>
          </div>

          <div class="footer-section">
            <h3>Bağlı Kuruluşlar</h3>
            <p>
              <a href="https://www.erzurum.bel.tr" target="_blank"
                >Erzurum Büyükşehir Belediyesi</a
              >
            </p>
            <p>
              <a href="https://www.ktb.gov.tr/" target="_blank" rel="noopener"
                >Kültür ve Turizm Bakanlığı</a
              >
            </p>
            <p>
              <a href="http://www.erzurum.gov.tr/" target="_blank" rel="noopener"
                >Erzurum Valiliği</a
              >
            </p>
            <p>
              <a href="https://erzurumdiplomasi.org/" target="_blank" rel="noopener"
                >Erzurum Diplomasi Akademisi</a
              >
            </p>
            <p>
              <a href="https://www.bilimerzurum.org/" target="_blank" rel="noopener"
                >Bilim Erzurum</a
              >
            </p>
          </div>
        </div>

        <div class="footer-bottom">
          <p>&copy; 2024 EBB Kültür ve Sanat Merkezi. Tüm hakları saklıdır.</p>
        </div>
      </div>
    </footer>

    <!-- Firebase -->
    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
      import {
        getFirestore,
        collection,
        addDoc,
        getDocs,
        Timestamp,
      } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

      const firebaseConfig = {
        apiKey: "AIzaSyD978ixFjE9KVlNsm6-BYww3B6S4qPVLfQ",
        authDomain: "ebbkultursanatapp.firebaseapp.com",
        projectId: "ebbkultursanatapp",
        storageBucket: "ebbkultursanatapp.appspot.com",
        messagingSenderId: "540910775157",
        appId: "1:540910775157:web:4af35312414acf20bd013c",
        measurementId: "G-4JCKV13ER8",
      };

      const app = initializeApp(firebaseConfig);
      const db = getFirestore(app);

      const form = document.getElementById("applicationForm");
      const submitBtn = document.getElementById("submitBtn");
      const successMessage = document.getElementById("successMessage");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();

        const firstName = document.getElementById("firstName").value.trim();
        const lastName = document.getElementById("lastName").value.trim();
        const birthDate = document.getElementById("birthDate").value;
        const gender = document.querySelector('input[name="gender"]:checked')?.value;
        const phone = document.getElementById("phone").value.trim();
        const email = document.getElementById("email").value.trim();

        // Validation
        let isValid = true;
        const errors = {};

        if (!firstName) {
          errors.firstName = "Ad alanı zorunludur";
          isValid = false;
        }
        if (!lastName) {
          errors.lastName = "Soyad alanı zorunludur";
          isValid = false;
        }
        if (!birthDate) {
          errors.birthDate = "Doğum tarihi zorunludur";
          isValid = false;
        }
        if (!gender) {
          errors.gender = "Cinsiyet seçimi zorunludur";
          isValid = false;
        }
        if (!phone) {
          errors.phone = "Telefon alanı zorunludur";
          isValid = false;
        } else if (!/^[\+]?[0-9\s\-\(\)]{10,}$/.test(phone)) {
          errors.phone = "Geçerli bir telefon numarası girin";
          isValid = false;
        }
        if (!email) {
          errors.email = "E-posta alanı zorunludur";
          isValid = false;
        } else if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
          errors.email = "Geçerli bir e-posta adresi girin";
          isValid = false;
        }

        // Show errors
        Object.keys(errors).forEach((key) => {
          const errorElement = document.getElementById(`${key}-error`);
          const inputElement = document.getElementById(key);
          if (errorElement) {
            errorElement.textContent = errors[key];
            errorElement.style.display = "block";
          }
          if (inputElement) {
            inputElement.classList.add("error");
          }
        });

        // Clear errors for valid fields
        Object.keys(errors).forEach((key) => {
          if (!errors[key]) {
            const errorElement = document.getElementById(`${key}-error`);
            const inputElement = document.getElementById(key);
            if (errorElement) {
              errorElement.style.display = "none";
            }
            if (inputElement) {
              inputElement.classList.remove("error");
            }
          }
        });

        if (!isValid) {
          return;
        }

        // Submit form
        try {
          submitBtn.disabled = true;
          submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Gönderiliyor...';

          await addDoc(collection(db, "formApplications"), {
            formType: "anadolunun-renkleri",
            firstName,
            lastName,
            birthDate,
            gender,
            phone,
            email,
            createdAt: Timestamp.now(),
            status: "pending",
          });

          successMessage.style.display = "block";
          form.reset();
          window.scrollTo({ top: 0, behavior: "smooth" });

          setTimeout(() => {
            successMessage.style.display = "none";
          }, 5000);
        } catch (error) {
          console.error("Form submission error:", error);
          alert(
            "Başvurunuz gönderilirken bir hata oluştu. Lütfen tekrar deneyin."
          );
        } finally {
          submitBtn.disabled = false;
          submitBtn.innerHTML =
            '<i class="fas fa-paper-plane me-2"></i>Başvuruyu Gönder';
        }
      });

      // Clear errors on input
      form.querySelectorAll("input").forEach((input) => {
        input.addEventListener("input", () => {
          const errorElement = document.getElementById(`${input.id}-error`);
          if (errorElement) {
            errorElement.style.display = "none";
          }
          input.classList.remove("error");
        });
      });
    </script>

    <!-- JavaScript -->
    <script src="js/index.js"></script>
    <script type="module">
      // Load active forms for dropdown
      async function loadActiveForms() {
        try {
          console.log("Loading active forms...");
          const formsSnapshot = await getDocs(collection(db, "forms"));
          const activeForms = [];
          
          formsSnapshot.forEach((doc) => {
            const formData = doc.data();
            const isActive = formData.isActive !== false; // Default to true
            
            // Check if form has expired
            let isExpired = false;
            if (formData.endDate) {
              const endDate = formData.endDate?.toDate 
                ? formData.endDate.toDate() 
                : new Date(formData.endDate);
              isExpired = new Date() > endDate;
            }
            
            // Only add active and not expired forms
            if (isActive && !isExpired) {
              activeForms.push({
                id: formData.id || doc.id,
                title: formData.title || "Form",
              });
            }
          });

          console.log("Active forms found:", activeForms);

          // Update dropdown menu - try multiple times if needed
          let dropdownMenu = document.getElementById("formsDropdown");
          let attempts = 0;
          while (!dropdownMenu && attempts < 10) {
            await new Promise(resolve => setTimeout(resolve, 100));
            dropdownMenu = document.getElementById("formsDropdown");
            attempts++;
          }
          
          console.log("Dropdown menu element:", dropdownMenu);
          
          if (dropdownMenu && activeForms.length > 0) {
            dropdownMenu.innerHTML = activeForms
              .map(
                (form) =>
                  `<li><a href="form-application.html?id=${form.id}" class="dropdown-item">${form.title}</a></li>`
              )
              .join("");
            console.log("Dropdown menu updated with", activeForms.length, "forms");
          } else if (dropdownMenu && activeForms.length === 0) {
            dropdownMenu.innerHTML =
              '<li><span class="dropdown-item text-muted">Aktif form bulunmamaktadır</span></li>';
            console.log("No active forms found");
          } else {
            console.warn("Dropdown menu element not found after", attempts, "attempts!");
          }
        } catch (error) {
          console.error("Error loading active forms:", error);
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        loadActiveForms();
      });
    </script>
  </body>
</html>

